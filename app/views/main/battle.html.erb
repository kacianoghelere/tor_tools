<% provide(:title, 'Batalha') %>
<% provide(:label, 'Batalha') %>

<div class="row-fluid">
	<div class="table-responsive">
		<table id="iniciativa" class="table table-condensed">
			<thead>
				<%= content_tag(:tr) do %>
					<%= content_tag(:th, "Nome",       width: "27%") %>
					<%= content_tag(:th, "Atributo",   width: "7%")  %>
					<%= content_tag(:th, "Resitência", width: "10%") %>
					<%= content_tag(:th, "Recurso",    width: "7%")  %>
					<%= content_tag(:th, "Aparar",     width: "7%")  %>
					<%= content_tag(:th, "Armadura",   width: "7%")  %>
					<%= content_tag(:th, "Posição",    width: "10%") %>
					<%= content_tag(:th, "Iniciativa", width: "7%")  %>
					<%= content_tag(:th, "NA Total",   width: "7%")  %>
				<% end %>
			</thead>
			<tbody></tbody>
		</table>
	</div>
</div>

<div class="row-fluid">
	<div class="pull-left">
		<%= button_tag type: "button", name: "adicionar", 
												class: "btn btn-success btn-xs" do %>
			<%= link_icon("plus", "Adicionar") %>
		<% end %>
	</div>
	<div class="pull-right">
		<%= button_tag type: "button", name: "replicar", 
												class: "btn btn-default btn-xs" do %>
			<%= link_icon("duplicate", "Replicar") %>
		<% end %>
		<%= button_tag type: "button", name: "gerar", 
												class: "btn btn-default btn-xs" do %>
			<%= link_icon("cog", " Gerar Iniciativa") %>
		<% end %>
	</div>
</div>

<script type="text/javascript">
	$(document).ready(function() {
		$(document).on('click', 'button[name="adicionar"]', function(event) {
			$.adicionarItem();
		});

		$(document).on('click', 'button[name="remover"]', function(event) {
			$(this).closest('tr.item-iniciativa').remove();
		});

		$(document).on('click', 'button[name="replicar"]', function(event) {
			$.replicar();
		});

		$(document).on('click', 'button[name="gerar"]', function(event) {
			$.gerarIniciativas();
		});

		$(document).on('change', 'select[name="posicao"]', function(event) {
			$.valor   = Number($(this).val());
			$.tr      = $(this).closest('tr.item-iniciativa');
			$.posicao = $.buscaPosicao($.valor);
			$.tr.removeClass("danger info success warning");
			$.tr.addClass($.posicao.classe);
			$.calcularNA(this);
		});

		$.adicionarItensInicio(1);
	});
</script>